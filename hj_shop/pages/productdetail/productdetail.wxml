<!--hj_shop/pages/productdetail/productdetail.wxml-->
<import src="../../../wxParse/wxParse.wxml" />
<import src="../../../lib/wxParse/wxParse.wxml" />
<wxs module="common" src="../../../utils/common.wxs"></wxs>

<swiper indicator-dots="{{indicatorDots}}" autoplay="{{autoplay}}" interval="{{interval}}" duration="{{duration}}">
	<block wx:for="{{productdetail}}" wx:key="item.id">
		<swiper-item>
			<image src="{{item.img}}" class="slide-image" />
		</swiper-item>
	</block>
</swiper>

<view class="info-wrap">
  <view class="info" wx:for="{{productdetail}}">
    <view class="left">
      <view class="title wux-ellipsis--l2">{{item.product_name}}</view>
      <!-- <view class="desc wux-ellipsis--l2">{{item.stock}}</view> -->
      <view class="price">￥{{item.price}}
        <text class="price-origin">￥{{item.market_price}}</text>
      </view>
	  
      <view class="tags" wx:if="{{tags.length > 0}}">
        <view wx:for="{{tags}}" wx:key="{{item.id}}" data-value="{{item}}" class="tag" hover-class="active" bindtap="clickTag">{{item.title}}
          <van-icon class="arrow" color="#f48f18" name="arrow" size="13px" />
        </view>
      </view>	  
    </view>
	
    <view class="right" bindtap="toComment">
      <view class="comment">
      <!--  <view class="comment-rate">{{product.comment.goodCommentRate}}%</view> -->
	   <!-- 后续单独创建评价表展示 -->
		<view class="comment-rate">100%</view>
        <text class="txt">好评率</text>
      </view>
      <van-icon class="arrow-icon" color="rgb(170, 170, 170)" name="arrow" size="18px" />
    </view>
  </view>

  <view class="vip-banner" bindtap="toVip">
    <view class="left">
      <image class="image" src="/images/temp/vip.png"></image>
      <text>超级会员价￥0.01</text>
    </view>

    <view class="right">
      <text>立即开通</text>
      <van-icon class="arrow-icon" name="arrow" size="13px" />
    </view>
  </view>
</view>

<view class="attr-wrap" hover-class="active" data-id="{{weigt_id}}" bindtap="showSku">
  <view class="attr">
    <view class="left">
      <text class="title">{{specText ? '已选' : '请选择数量规格'}}</text>
      <text class="txt">{{specText ? specText : ''}}</text>
    </view>
    <image class="arrow" src="/images/temp/rightArrow.png"></image>
  </view>
</view>

<view class="attr-wrap" hover-class="active" bindtap="openCoupon" wx:if="{{product.promotion==2}}">
  <view class="attr">
    <view class="left">
      <text class="title">领劵</text>
      <van-tag color="#f2826a" plain wx:for="{{couponList}}" wx:key="{{item.id}}">{{item.title}}</van-tag>
    </view>
    <image class="arrow" src="/images/temp/rightArrow.png"></image>
  </view>
</view>

<view class="attr-wrap" wx:if="{{product.promotion==1}}">
  <view class="attr">
    <view class="left">
      <text class="title">限制</text>
      <text class="limit">特价商品不可与优惠券叠加使用</text>
    </view>
  </view>
</view>

<view class="attr-wrap" hover-class="active" bindtap="openAddress">
  <view class="delivery">
    <view class="title">配送</view>
    <view class="right">
      <view class="info">
        <text class="address wux-ellipsis">{{deliveryAddress.address}}</text>
        <text class="time">{{deliveryAddress.time}}前完成支付, 预计({{deliveryAddress.diff}}){{deliveryAddress.day}}送达</text>
      </view>
      <image class="arrow" src="/images/temp/rightArrow.png"></image>
    </view>
  </view>
</view>

<view class="attr-wrap" hover-class="active" bindtap="openService">
  <view class="service">
    <text class="title">服务</text>
    <view class="right">
      <view class="info">
        <view class="item" wx:for="{{product.serviceList}}" wx:key="{{item.id}}">
          <view class="red-point"></view>{{item.title}}
        </view>
      </view>
      <image class="arrow" src="/images/temp/rightArrow.png"></image>
    </view>
  </view>
</view>

<!-- 详情 -->
<!-- <view class="detail">
  <template is="wxParse" data="{{wxParseData:item.product_content.nodes}}" />
</view> -->

<!-- 底部按钮 -->
 <view class="bottom">
  <view class="b-wrap collect" hover-class="active" bindtap="openIndexPage">
    <van-icon name="wap-home-o" color="#777" size="20px" />
	<text style="font-size: 20rpx;">首页</text>
  </view>
  <view class="b-wrap service-icon" hover-class="active">
    <button open-type="contact" hover-class="none" class="wxbtn">
      <van-icon name="service-o" color="#777" size="20px" />
    </button>
	<text style="font-size: 20rpx;">客服</text>
  </view>
  <view class="b-wrap cart" hover-class="active" bindtap="openCartPage">
    <van-icon custom-class="icon-info" name="shopping-cart-o" info="{{cartList.length>0 ? cartList.length:''}}" color="#777" size="20px" />
	<!-- <text style="font-size: 20rpx;">购物车</text> -->
  </view>
  <view class="buy" hover-class="active" bindtap="buyNow">立即购买</view>
  <view class="add-cart" hover-class="active" bindtap="addToCart">加入购物车</view>
</view> 

<!-- 优惠券选择 -->
<van-popup show="{{ couponShow }}" class="coupon-pop" position="bottom" bind:close="closeCoupon">
  <view class="title">领劵</view>
  <view class="coupon-wrap">
    <coupon data="{{item}}" wx:for="{{couponList}}" wx:key="{{item.id}}" data-value="{{item}}" bindtap="choose" class="item" />
  </view>
</van-popup>

<!-- 服务详情 -->
<van-popup show="{{ serviceShow }}" position="bottom" bind:close="closeService">
  <view class="service-wrap">
    <view class="h">服务</view>
    <scroll-view class="c" scroll-y="true">
      <view class="desc" wx:for="{{product.serviceList}}" wx:key="{{item.id}}">
        <view class="dt">
          {{item.title}}
        </view>
        <view class="dc">
          {{item.desc}}
        </view>
      </view>
    </scroll-view>
  </view>
</van-popup>

<!-- 商品规格选择 -->
<van-popup show="{{show}}" position="bottom" bind:close="closeSku"  >
  <view class="sku">
    <!-- 关闭图标 -->
    <van-icon name="cross" color="#999" class="close" bindtap="closeSku" />
    <!-- 图片标价 -->
    <view class="info">
     <image class="img" src="{{productdetail.img}}"  bindtap="previewThumb"></image>
	  <!-- <image class="img" src="{{product.picUrl}}"  bindtap="previewThumb"></image> -->
      <view class="sku-desc">
        <van-tag wx:if="{{product.promotion==1}}" color="#f48f18" style="margin-bottom: 10rpx">限时购</van-tag>
        <view class="price">价格：￥{{productdetail.price}}
          <view class="origin-price">￥{{productdetail.market_price}}</view>
        </view>
        <view class="spec" wx:if="{{!noneSku}}">{{specText ? '已选择:'+specText : '请选择规格属性'}}</view>
      </view>
	  
    </view>
	
    <view wx:for="{{skuinfo}}" wx:key="{{index}}" data-value="{{item}}">
      <view class="title">{{kname}}</view>
    <view class="wrap">
        <view class="value {{iitem.selected ? 'selected':''}} {{iitem.disabled ? 'disabled':''}}" wx:for="{{item.kweigt}}" wx:for-item="iitem" wx:for-index="iindex" wx:key="{{iindex}}" data-index="{{index}}" 
    	data-iindex="{{iindex}}" data-k="{{item}}" data-value="{{iitem}}"
          bindtap="selectSku">{{kweigt}}</view>
      </view>
    </view>

    <view class="title ">数量</view>
    <i-input-number value="{{ count }} " min="1 " max="{{quota}}" bindchange="changeCount" />
    <view style="width: 1rpx;"></view>
  </view>
</van-popup>

<van-toast id="van-toast" />